$(function() {

	$('#anoAtual').html(new Date().getFullYear());
	$('#divCargos').hide();
	$('#outros').hide();

	// scroll smooth
	$('a[href*="#"]:not([href="#"])').click(function() {
	if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
	  	var target = $(this.hash);
	  	target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
	  	if (target.length) {
		    $('html, body').animate({
		      scrollTop: target.offset().top
		    }, 1000);
	    	return false;
	  	}
		}
	});

	var SPMaskBehavior = function (val) {
		return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';
	},
	spOptions = {
	  onKeyPress: function(val, e, field, options) {
	      field.mask(SPMaskBehavior.apply({}, arguments), options);
	    }
	};

	$('#telefone').mask(SPMaskBehavior, spOptions);

	// listar os cargos
	/*
	$.post("includes/controller.site.php", 
	{
		acao: 'listarCargos'  
	}, 
		function(result){
			console.log(result);
			
    	}
    );*/

    $('#cargo').change(function()
    {
    	if ($('#cargo').val() == '3')
    	{
    		$('#divCargos').show();
    		$('#outroCargo').focus();
    	}
    	else
    	{
    		$('#divCargos').hide();
    	}
    });

    $('#principalNegocio').change(function()
    {
    	if ($('#principalNegocio').val() == '3')
    	{
    		$('#outros').show();
    		$('#outroNegocio').focus();
    	}
    	else
    	{
    		$('#outros').hide();
    	}
    });

    $.post("includes/controller.site.php", 
    	{ acao: "listarCargos" }, 
    	function(resposta) {
    		var resultado = JSON.parse(resposta);			
			$.each(resultado, function (i, valor) {
			    $('#cargo').append($('<option>', { 
			        value: valor.IdCargos,
			        text : valor.Cargo 
			    }));
			});

	});

	// formulario de cadastro
	$('#registrar').click(function()
	{
		$('#nomeValido').val('');
		$('#emailValido').val('');

		var nome = $('#nome').val();
		var email = $('#email').val();
		var telefone = $('#telefone').val();
		var nomeEmpresa = $('#nomeEmpresa').val();
		var cargo = $('#cargo').val();
		var outroCargo = $('#outroCargo').val();
		var qtdePetsVendas = $('#qtdePetsVendas').val();
		var principalNegocio = $('#principalNegocio').val();
		var outroNegocio = $('#outroNegocio').val();
		var qtdeAnuncios = $('#qtdeAnuncios').val();
		var validado = false;

		// se tiver tudo certo, envia para o método
		if (nome != "" && email != "")
		{
			$.post("includes/controller.site.php", 
			{
				nome: nome, email: email, telefone: telefone,
				nomeEmpresa: nomeEmpresa, cargo: cargo, outroCargo: outroCargo, 
				qtdePetsVendas: qtdePetsVendas, principalNegocio: principalNegocio,
				outroNegocio: outroNegocio, qtdeAnuncios: qtdeAnuncios,
				acao: 'cadastrar'  
			}, 
				function(resposta){	
					var resultado = JSON.parse(resposta);
					swal(resultado.titulo, resultado.msg, resultado.tipo);
		    	}
		    );
		}
		else 
		{
			if (nome == "")
				$('#nomeValido').html("<small>Por favor, diga seu nome <b>:)</b></small>");

			if (email == "")
				$('#emailValido').html("<small>Ah! passa seu e-mail pra gente <b>:)</b></small>");
		}

		/*
		console.log("Nome: " + nome + " - E-mail: " + email + " - Telefone: " + telefone
			 + " - Nome da empresa: " + nomeEmpresa + " - Cargo: " + cargo + " - Outro Cargo: " + outroCargo
			  + " - Qtde Vendas: " + qtdePetsVendas + " - Principal negócio: " + principalNegocio + " - Outro negocio: " + outroNegocio 
			   + " - Qtde Anúncios: " + qtdeAnuncios);*/

		
	});



});
